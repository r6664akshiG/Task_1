<!DOCTYPE html>
<html>
<head>
    <title>PDF Upload Portal</title>
</head>
<body>
    <h2>Upload Medical PDF</h2>

    <input type="file" id="fileInput" accept=".pdf">
    <button onclick="uploadFile()">Upload</button>
    <p id="message"></p>


    <script>
        // Upload 
        async function uploadFile() {
            const file = document.getElementById('fileInput').files[0];

            if (!file) {
                document.getElementById('message').innerText = "Please select a PDF file.";
                return;
            }

            const formData = new FormData();
            formData.append('file', file);

            try {
                const res = await fetch('http://127.0.0.1:5000/documents/upload', {
                    method: 'POST',
                    body: formData
                });
                const result = await res.json();
                document.getElementById('message').innerText = result.message;
                loadFiles(); 
            } catch {
                document.getElementById('message').innerText = "Upload failed!";
            }
        }

        
        async function loadFiles() {
            const res = await fetch('http://127.0.0.1:5000/documents');
            const files = await res.json();

            const list = document.getElementById('fileList');
            list.innerHTML = '';

            files.forEach(file => {
                const item = document.createElement('li');

                //Delete
                const deleteBtn = document.createElement('button');
                deleteBtn.innerText = 'Delete';
                deleteBtn.onclick = async () => {
                    await fetch(`http://127.0.0.1:5000/documents/${file.id}`, { method: 'DELETE' });
                    loadFiles(); 
                };

                // Download 
                const downloadBtn = document.createElement('button');
                downloadBtn.innerText = 'Download';
                downloadBtn.onclick = () => {
                    window.open(`http://127.0.0.1:5000/documents/${file.id}`);
                };
                
            });
        }

        
    
    </script>
</body>
</html>

